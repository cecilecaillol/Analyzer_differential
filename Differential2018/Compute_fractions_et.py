if __name__ == "__main__":

    import ROOT
    import argparse

    parser = argparse.ArgumentParser()
    parser.add_argument('--scale', default="nominal", choices=['nominal', 'up', 'down', 'wup', 'wdown','qcdup','qcddown','JESup','JESdown'], help="Which TES?")
    options = parser.parse_args()

    fDY=ROOT.TFile("files_diff_et/DY.root","r")
    fEmbedded=ROOT.TFile("files_diff_et/embedded.root","r")
    fW=ROOT.TFile("files_diff_et/W.root","r")
    fTT=ROOT.TFile("files_diff_et/TT.root","r")
    fVV=ROOT.TFile("files_diff_et/VV.root","r")
    fData=ROOT.TFile("files_diff_et/Data.root","r")
    fout=ROOT.TFile("files_diff_et/fractions.root","recreate")

    h_pth0to45_w=fW.Get("f0jet")
    h_pth0to45_w.Add(fDY.Get("f0jet"))
    h_pth0to45_w.Add(fVV.Get("f0jet"))
    h_pth0to45_tt=fTT.Get("f0jet")
    h_pth0to45_data=fData.Get("f0real")
    h_pth0to45_real=fDY.Get("f0real")
    h_pth0to45_real.Add(fEmbedded.Get("f0real"))
    h_pth0to45_real.Add(fTT.Get("f0real"))
    h_pth0to45_real.Add(fVV.Get("f0real"))
    h_pth0to45_qcd=h_pth0to45_data.Clone()
    h_pth0to45_qcd.Add(h_pth0to45_real,-1)
    h_pth0to45_qcd.Add(h_pth0to45_tt,-1)
    h_pth0to45_qcd.Add(h_pth0to45_w,-1)
    h_pth0to45_w.SetName("frac_w_pth0to45")
    h_pth0to45_qcd.SetName("frac_qcd_pth0to45")
    h_pth0to45_tt.SetName("frac_tt_pth0to45")
    h_pth0to45_data.SetName("frac_data_pth0to45")

    h_pth45to80_w=fW.Get("f1jet")
    h_pth45to80_w.Add(fDY.Get("f1jet"))
    h_pth45to80_w.Add(fVV.Get("f1jet"))
    h_pth45to80_tt=fTT.Get("f1jet")
    h_pth45to80_data=fData.Get("f1real")
    h_pth45to80_real=fDY.Get("f1real")
    h_pth45to80_real.Add(fEmbedded.Get("f1real"))
    h_pth45to80_real.Add(fTT.Get("f1real"))
    h_pth45to80_real.Add(fVV.Get("f1real"))
    h_pth45to80_qcd=h_pth45to80_data.Clone()
    h_pth45to80_qcd.Add(h_pth45to80_real,-1)
    h_pth45to80_qcd.Add(h_pth45to80_tt,-1)
    h_pth45to80_qcd.Add(h_pth45to80_w,-1)
    h_pth45to80_w.SetName("frac_w_pth45to80")
    h_pth45to80_qcd.SetName("frac_qcd_pth45to80")
    h_pth45to80_tt.SetName("frac_tt_pth45to80")
    h_pth45to80_data.SetName("frac_data_pth45to80")

    h_pth80to120_w=fW.Get("f2jet")
    h_pth80to120_w.Add(fDY.Get("f2jet"))
    h_pth80to120_w.Add(fVV.Get("f2jet"))
    h_pth80to120_tt=fTT.Get("f2jet")
    h_pth80to120_data=fData.Get("f2real")
    h_pth80to120_real=fDY.Get("f2real")
    h_pth80to120_real.Add(fEmbedded.Get("f2real"))
    h_pth80to120_real.Add(fTT.Get("f2real"))
    h_pth80to120_real.Add(fVV.Get("f2real"))
    h_pth80to120_qcd=h_pth80to120_data.Clone()
    h_pth80to120_qcd.Add(h_pth80to120_real,-1)
    h_pth80to120_qcd.Add(h_pth80to120_tt,-1)
    h_pth80to120_qcd.Add(h_pth80to120_w,-1)
    h_pth80to120_w.SetName("frac_w_pth80to120")
    h_pth80to120_qcd.SetName("frac_qcd_pth80to120")
    h_pth80to120_tt.SetName("frac_tt_pth80to120")
    h_pth80to120_data.SetName("frac_data_pth80to120")

    h_pth120to200_w=fW.Get("f3jet")
    h_pth120to200_w.Add(fDY.Get("f3jet"))
    h_pth120to200_w.Add(fVV.Get("f3jet"))
    h_pth120to200_tt=fTT.Get("f3jet")
    h_pth120to200_data=fData.Get("f3real")
    h_pth120to200_real=fDY.Get("f3real")
    h_pth120to200_real.Add(fEmbedded.Get("f3real"))
    h_pth120to200_real.Add(fTT.Get("f3real"))
    h_pth120to200_real.Add(fVV.Get("f3real"))
    h_pth120to200_qcd=h_pth120to200_data.Clone()
    h_pth120to200_qcd.Add(h_pth120to200_real,-1)
    h_pth120to200_qcd.Add(h_pth120to200_tt,-1)
    h_pth120to200_qcd.Add(h_pth120to200_w,-1)
    h_pth120to200_w.SetName("frac_w_pth120to200")
    h_pth120to200_qcd.SetName("frac_qcd_pth120to200")
    h_pth120to200_tt.SetName("frac_tt_pth120to200")
    h_pth120to200_data.SetName("frac_data_pth120to200")

    h_pthgt200_w=fW.Get("f4jet")
    h_pthgt200_w.Add(fDY.Get("f4jet"))
    h_pthgt200_w.Add(fVV.Get("f4jet"))
    h_pthgt200_tt=fTT.Get("f4jet")
    h_pthgt200_data=fData.Get("f4real")
    h_pthgt200_real=fDY.Get("f4real")
    h_pthgt200_real.Add(fEmbedded.Get("f4real"))
    h_pthgt200_real.Add(fTT.Get("f4real"))
    h_pthgt200_real.Add(fVV.Get("f4real"))
    h_pthgt200_qcd=h_pthgt200_data.Clone()
    h_pthgt200_qcd.Add(h_pthgt200_real,-1)
    h_pthgt200_qcd.Add(h_pthgt200_tt,-1)
    h_pthgt200_qcd.Add(h_pthgt200_w,-1)
    h_pthgt200_w.SetName("frac_w_pthgt200")
    h_pthgt200_qcd.SetName("frac_qcd_pthgt200")
    h_pthgt200_tt.SetName("frac_tt_pthgt200")
    h_pthgt200_data.SetName("frac_data_pthgt200")

    fout.cd()
    h_pth0to45_w.Write()
    h_pth0to45_tt.Write()
    h_pth0to45_qcd.Write()
    h_pth0to45_data.Write()

    h_pth45to80_w.Write()
    h_pth45to80_tt.Write()
    h_pth45to80_qcd.Write()
    h_pth45to80_data.Write()

    h_pth80to120_w.Write()
    h_pth80to120_tt.Write()
    h_pth80to120_qcd.Write()
    h_pth80to120_data.Write()

    h_pth120to200_w.Write()
    h_pth120to200_tt.Write()
    h_pth120to200_qcd.Write()
    h_pth120to200_data.Write()

    h_pthgt200_w.Write()
    h_pthgt200_tt.Write()
    h_pthgt200_qcd.Write()
    h_pthgt200_data.Write()

